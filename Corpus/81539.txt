 URL : "https://github.com/dvajs/dva/issues/1028" TITLE : 轮询 yield race 无效 BODY : 需要轮询 但是取消请求无效。麻烦看一下。 javascript effects:{ polldata { id }, { call, put } { try { yield call service.delay, 3000 ; yield put { type: fetchprogress , id } ; } catch error { return; } }, watchpolling { id }, { take, race } { while true { yield take fetchdone ; yield race put { type: polldata , id } , take cancelpolling ; //doesn't work } }, watchcancel {}, { take } { yield take cancelpolling ; console.info cancel taken //works }, fetchinfo { id }, { call, put } { const info = yield call service.fetchinfo, {id} ; const { err } = info; if !err { yield put { type: fetchdone , info } ; } }, startpolling { id }, { put } { yield put { type: watchpolling , id } ; yield put { type: watchcancel } ; yield put { type: fetchinfo , id } ; } }, subscriptions: { setup { dispatch, history } { return history.listen { pathname, query } => { if pathname === /users { dispatch { type: startpolling , id: 1 } ; } } , history.listenbefore => { dispatch { type: cancelpolling } ; } ; } }