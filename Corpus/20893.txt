 URL : "https://github.com/TrinityCore/TrinityCore/issues/20124" TITLE : delete npc crashes BODY : <!--- fill in the following fields ---> description: using .npc delete command crashes here is a all stack of a sort. creature::deletefromdb crashes and the reason is the call stack below where most recent call is last. getcreaturebyspawnidstore is modified while looped through. deletefromdb is called by .npc delete command. creature::deletefromdb -- loops through getmap ->getcreaturebyspawnidstore .equal_range worldobject::addobjecttoremovelist map::addobjecttoremovelist worldobject::cleanupsbeforedelete creature::removefromworld -- calls trinity::containers::multimaperasepair getmap ->getcreaturebyspawnidstore , m_spawnid, this ; result: invalid iterator current behaviour: using .npc delete crashes expected behaviour: using .npc delete deletes the targeted creature steps to reproduce the problem: 1. spawn an npc by using .npc add 36 2. delete the npc by targeting it and using .npc delete branch es : 3.3.5 tc rev. hash/commit: https://github.com/trinitycore/trinitycore/commit/f9f5a701f48bbb703658a99d689270d6bd7469c6 tdb version: operating system: windows <!--- notes - this template is for problem reports. for other types of report, edit it accordingly. - for fixes containing c++ changes, create a pull request. --->