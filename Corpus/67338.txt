 URL : "https://github.com/szepeviktor/wordpress-fail2ban/issues/5" TITLE : plans for the mu plugin BODY : - non-attack 404: logsearch.sh -e wpf2b_404|sed -ne 's|. wpf2b_404 s: 0-9 \+: \ ^ \ ; . |\1|p'|grep -vx / a-z/- \+/\|. \.jpg |sort + non-ascii post slugs - fake googlebot, referer: http://www.google.com grep -hi ' ^ googlebot ^ $' /var/log/apache2/ access.log|grep -v ^66\.249\. - core: no filter for successful xmlrpc login in wp_authenticate - write test.sh - robot requests not through /index.php exclude: xmlrpc, trackback, see: wp_403 - append: http://plugins.svn.wordpress.org/block-bad-queries/trunk/block-bad-queries.php - option to immediately ban on non-wp scripts \.php$ \.aspx?$ - update non-mu plugin's code - new: invalid user/email during registration - new: invalid user during lost password - new: invalid lost password token - robots & errors in /wp-comments-post.php as in block-bad-requests.inc - log xmlrpc? add_action 'xmlrpc_call', function $call { if 'pingback.ping' == $call {} } ; - log proxy ip: http_x_forwarded_for, http_incap_client_ip, http_cf_connecting_ip could be faked - registration errors: the dirty way add_filter 'login_errors', function $em { error_log 'em:' . $em ; return $em; }, 0 ; - bad queries https://github.com/wp-plugins/block-bad-queries/ - bad uas