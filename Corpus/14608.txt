 URL : "https://github.com/getkirby/getkirby.com/issues/340" TITLE : better csrf guide BODY : i was fiddling around with the csrf helper, and i'm glad i tested it, because the code i used did not work. according to <https://getkirby.com/docs/toolkit/api/helpers/csrf>, we should do: html <input type= hidden name= csrf value= <?php echo csrf ?> > and php $token = get 'csrf' ; if csrf $token === true { // success } else { // token doesn't match } but i was trying to get it shorter and used: php if !csrf get 'csrf' return response::error 'csrf token does not match', 403 ; but, since csrf null returns a new token, the if will not trigger when $_post 'csrf' is not set, so the script goes through. so, a shorter but working one is this: php if csrf get 'csrf' !== true return response::error 'csrf token does not match', 403 ; maybe: 1. add a warning for this to this page in the docs 2. a cookbook recipe with more in dept about csrf might be nice too? : 3. shouldn't this be avoided in the code as well, so it's harder to make this mistake? don't know.