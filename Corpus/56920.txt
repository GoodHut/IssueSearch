 URL : "https://github.com/kuzyn/chatscript-tmlanguage/issues/55" TITLE : overspilling with ^ \^ BODY : escaping string is too greedy ! screen shot 2017-04-12 at 9 30 19 am https://cloud.githubusercontent.com/assets/1139068/24960152/ed1d18ae-1f62-11e7-953e-db36566d3a8c.png { if $_value { $_obj = ^jsoncreate transient object $_obj.x = $_value if $_obj.x { escape carets to play nice with jsonwrite if ^findtext $_item \^ 0 { $_text = ^substitute character $_item \^ ^ \^ } $_text = ^jsonwrite $_obj allow cs to do the escaping $_end = ^length $_text - 2 $_text = ^extract $_text 7 $_end } } if $_text { ^log output_nocommanumber file $_filename $_text } else { ^log file $_filename ^join nu ll } }