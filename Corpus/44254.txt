 URL : "https://github.com/LaplacesDemonR/LaplacesDemon/issues/10" TITLE : error in dmatrixgamma BODY : hello, there's an error in dmatrixgamma . as said in the help, the matrix variate gamma distribution is the same as the wishart distribution when alpha=nu/2 and beta=2 . this equality does not occur: > s <- rwishart 4, diag 4 > sigma <- rwishart 4, diag 4 > dwishart s, nu, sigma, log=true 1 -25.80533 > dmatrixgamma s, nu/2, 2, sigma, true 1 -19.44854 the fix consists in replacing dens <- logdet omega + ... with dens <- alpha logdet omega + ... : mydmatrixgamma <- function x, alpha, beta, sigma, log = false { k <- nrow sigma gamsum <- 0 for i in 1:k gamsum <- gamsum + lgamma alpha - 0.5 i - 1 gamsum <- gamsum + log pi k k - 1 /4 omega <- as.inverse sigma dens <- alpha logdet omega + logdet x alpha - 0.5 k + 1 - log beta k alpha + gamsum + -1/beta tr omega % % x if log == false dens <- exp dens return dens } > dwishart s, nu, sigma, log=true 1 -25.80533 > mydmatrixgamma s, nu/2, 2, sigma, true 1 -25.80533 by the way i don't understand the interest of this distribution. it is the same as the wishart distribution with scale matrix beta/2 sigma : > beta <- 3 > dwishart s, nu, beta/2 sigma, log=true 1 -28.2996 > mydmatrixgamma s, nu/2, beta, sigma, true 1 -28.2996 this fact allows to easily implement rmatrixgamma by the way, which is missing.