 URL : "https://github.com/yuhongchun/automation/issues/2" TITLE : mysql db backup BODY : 你书上那个mysql备份脚本不是很理解，于是在网上搜集一个简单的脚本，执行是成功了。但是还有两个问题，想请教一下！（应该还是shell脚本命令没有理解） !/bin/sh 备份数据库 backup_dir=/data/backup/mysql data_dir=/data/backup/dbdata 查询mysql中所有数据库名字 sql_string= select schema_name as db from information_schema.schemata where schema_name not in 'mysql', 'information_schema', 'performance_schema' ; dbs=$ echo $sql_string | mysql -u$mysql_user -p$mysql_pass -bs 当前日期 date=$ date -d '+0 days' +%y%m%d%h%m 打包名称 zip_name= mysql_ $date .gz 删除一个月之前的数据库备份 find $backup_dir -name mysql_ .gz -type f -mtime +30 -exec rm {} \; 循环备份数据库 for dbname in $dbs do if ! -d ${data_dir} ; then mkdir -p ${data_dir} fi sql_file=$dbname-$date .sql /usr/bin/mysqldump -u$mysql_user -p$mysql_pass $dbname > $data_dir/$sql_file done tar打包所有sql文件到指定路径 tar -czvpf $backup_dir/$zip_name $data_dir 打包成功后删除sql文件 if $? = 0 ; then mv ${sql_file} ${sql_file}.bak rm -r $data_dir fi q1.打包的时候虽然指定了存放路径，但是打包文件没有放在指定的路径里，而是跑到了根目录下/ q2. mv 的时候报错，但是在终端命令行中mv 是可以正常执行的 报错信息： mv: 无法获取 ssm-201704131815.sql 的文件状态 stat : 没有那个文件或目录 ssm是一个数据库名称