 URL : "https://github.com/fchollet/keras/issues/5003" TITLE : input dimension mis-match BODY : i'm not sure if this is an issue with keras or with theano, but i'm having trouble with the following model: from keras.models import sequential from keras.layers import gru, timedistributed, dense, embedding, activation import numpy as np import theano theano.config.exception_verbosity = high theano.config.optimizer = none n_characters = 12 seq_length = 1 batch_size = 64 model = sequential model.add embedding n_characters, n_characters, input_length=seq_length, batch_input_shape= batch_size, seq_length , mask_zero=true, weights= np.diag np.ones n_characters , trainable=false model.add gru 128, return_sequences=true, stateful=true model.add activation tanh model.add timedistributed dense n_characters, activation='softmax' model.compile optimizer='rmsprop', loss='categorical_crossentropy' when i run test_input = np.array 1 for _ in range seq_length for _ in range batch_size model.predict test_input i get the following error > valueerror: input dimension mis-match. input 0 .shape 0 = 32, input 1 .shape 0 = 64 what's interesting is that if i set batch_size to 32 or less, then the model works fine, but as soon as it's increased beyond that, i get this error. am i doing something wrong? thanks iain