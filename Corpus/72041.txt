 URL : "https://github.com/lpsmith/postgresql-simple/issues/202" TITLE : atomic withtransaction ? BODY : is there a recommended way to perform an atomic withtransaction block? the following deadlocks: withmvar connectionhandle conn $ \_ -> do withtransaction conn -- deadlocks since begin needs to acquire the lock ... the only other things i can think of are using an extra mvar to synchronize on the connection , or somehow abusing unsafeiotostm .. both of which seem prone to error.