 URL : "https://github.com/erigones/esdc-factory/issues/91" TITLE : automate creating overlays BODY : this is proposal of a script that will automate overlay creation on compute nodes using ansible. script name: /opt/erigones/bin/esdc-overlay usage: esdc-overlay create <node_list|all> <overlay_name> type example: esdc-overlay create all myoverlay1 what it will do: - verify parameters - overlay name must have a trailing number - check node names against ansible's hosts file - supported overlay type files or direct - execute ansible tasks over all selected nodes - verify node config presence of external ip - add overlay into config file - add overlay into /var/run/smartdc/networking/overlay_rules.json - refresh stored node info using dc api continue if failed - add ipsec rules - add firewall rules to allow this overlay connect among selected nodes the create command can be run multiple times to ensure the overlay is correctly setup. if the overlay already exists on a node, nothing will happen. it can also be run after adding a new node to extend existing overlay to this new node. other commands: esdc-overlay delete <overlay_name> esdc-overlay list the list command prints all overlays with nodes assigned to them. j.