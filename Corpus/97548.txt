 URL : "https://github.com/locationtech/geotrellis/issues/2383" TITLE : haversine formula has bugs BODY : the haversine formula in zoomedlayoutscheme seems to have a bug in it; i was using that logic to compute road distance metrics on osm ways and found odd results. when i changed the implementation to something that matched this https://github.com/njj/haversine/blob/master/haversine.js , i started getting sensible results. we should move to something like: scala val r = earth_radius val start, end = ll1, ll2 val dlat = math.toradians end.y - start.y val dlon = math.toradians end.x - start.x val lat1 = math.toradians start.y val lat2 = math.toradians end.y val a = math.sin dlat/2 math.sin dlat/2 + math.sin dlon/2 math.sin dlon/2 math.cos lat1 math.cos lat2 val c = 2 math.atan2 math.sqrt a , math.sqrt 1-a r c this only would effect area measurements for points that do not have valid utm zones, so probably doesn't have a huge effect. we should put the distance formula in geotrellis.utils or geotrellis.vector, so that it can be used outside of the zoomedlayoutscheme logic.