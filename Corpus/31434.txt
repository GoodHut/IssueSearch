 URL : "https://github.com/asciidoctor/asciidoctor-diagram/issues/137" TITLE : shrink plantuml jar BODY : plantuml is a pretty heavy dependency to embed in the asciidoctor-diagram gem. the asciidoctor-diagram gem is currently about 5m in size of which only 256k is asciidoctor-diagram itself. to shrink things down a bit i'm considering the following 1. compress the plantuml jar using pack200 compression. i'm not sure how to handle decompression of the pack200 file yet. at first i thought of abusing extconf.rb for this, but that would require finding a jre at gem installation time. i would prefer to avoid this. the file can be decompressed on first use of plantuml since we need a jre to run the plantuml code anyway. i'm not sure where to extract it to yet though. /tmp ? 2. shrink the plantuml jar using proguard. 3. shrink the plantuml jar by eliminating unused code. a quick review of the plantuml source code shows that it contains a lot of toy/fun/experimental code e.g., a transpiled version of graphviz, an ftp server, a telnet server, a working version of oregon trail, ... . imo it's silly to ship all this code that nobody uses. stripping all that stuff out already reduces the plantuml jar to half it's size. some quick experiments show that this can result in a gem file of about 540k. shrinking the gem by an order of magnitude seems worthwhile.