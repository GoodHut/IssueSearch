 URL : "https://github.com/QuazarTech/Boltzmann_solver/issues/22" TITLE : issue with fdtd solver BODY : there's a rather cryptic bug in the fdtd function in which the arrays are modified incorrectly. this issue seems to be similar to what was reported in 21. the following change is a temporary fix for the issue: changed from: python self.e1 += dt/dq2 self.b3 - af.shift self.b3, 0, 1 - self.j1 dt self.e2 += - dt/dq1 self.b3 - af.shift self.b3, 1, 0 - self.j2 dt self.e3 += dt/dq1 self.b2 - af.shift self.b2, 1, 0 \ - dt/dq2 self.b1 - af.shift self.b1, 0, 1 \ - dt self.j3 self.b1 += - dt/dq2 af.shift self.e3, 0, -1 - self.e3 self.b2 += dt/dq1 af.shift self.e3, -1, 0 - self.e3 self.b3 += - dt/dq1 af.shift self.e2, -1, 0 - self.e2 \ + dt/dq2 af.shift self.e1, 0, -1 - self.e1 to python self.e1 += dt/dq2 b3 - b3_shifted_q2 - self.j1 dt self.e2 += - dt/dq1 b3 - b3_shifted_q1 - self.j2 dt self.e3 += dt/dq1 b2 - b2_shifted_q1 \ - dt/dq2 b1 - b1_shifted_q2 \ - dt self.j3 self.b1 += - dt/dq2 e3_shifted_q2 - e3 self.b2 += dt/dq1 e3_shifted_q1 - e3 self.b3 += - dt/dq1 e2_shifted_q1 - e2 \ + dt/dq2 e1_shifted_q2 - e1 where: python e1 = self.e1.copy e2 = self.e2.copy e3 = self.e3.copy e1_shifted_q2 = af.shift e1, 0, -1 .copy e2_shifted_q1 = af.shift e2, -1, 0 .copy e3_shifted_q1 = af.shift e3, -1, 0 .copy e3_shifted_q2 = af.shift e3, 0, -1 .copy b1 = self.b1.copy b2 = self.b2.copy b3 = self.b3.copy b1_shifted_q2 = af.shift b1, 0, 1 .copy b2_shifted_q1 = af.shift b2, 1, 0 .copy b3_shifted_q1 = af.shift b3, 1, 0 .copy b3_shifted_q2 = af.shift b3, 0, 1 .copy