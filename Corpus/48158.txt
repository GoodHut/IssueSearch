 URL : "https://github.com/rdkit/rdkit/issues/1439" TITLE : removehs and h :1 mol BODY : i discovered some strange behavior of removehs function applied for ' h :1 ' molecule. if i create that mol from smiles, removehs does not remove a single h from the mol: mmm = chem.molfromsmiles ' h :1 ' chem.moltosmiles chem.removehs mmm output: ' h :1 ' if i apply removehs to fragments obtained after mmpa cuts it removes h and keeps only ' :1 ' mmm = chem.molfromsmiles 'c1ccccc1c' mmm = chem.addhs mmm fr = rdmmpa.fragmentmol mmm, pattern= !@!=! ! 1 , maxcuts=1, resultsasmols=true for f in fr: ff = chem.getmolfrags f 1 , asmols=true print chem.moltosmiles ff 0 , chem.moltosmiles chem.removehs ff 0 print chem.moltosmiles ff 1 , chem.moltosmiles chem.removehs ff 1 output: h c1c h c h c :1 c h c1 h c1ccc :1 cc1 h c h h :1 c :1 h c1c h c h c :1 c c h h h c1 h cc1ccccc1 :1 h :1 :1 h c1c h c c h h h c h c :1 c1 h cc1cccc :1 c1 h :1 :1 h c1c h c :1 c h c h c1c h h h cc1ccc :1 cc1 h :1 :1 h c1c h c h c c h h :1 c h c1 h c1ccc c :1 cc1 h :1 :1