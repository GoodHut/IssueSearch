 URL : "https://github.com/Arkq/bluez-alsa/issues/29" TITLE : adding msbc mode into hfp BODY : great piece of software! i am currently working on integrating this into our product in lieu of pulseaudio due to former's excessive cpu usage with bt audio. i am enhancing the hfp support by adding more at command handling some headsets drop the connection if the standard handshake is not followed and by adding msbc support. before i dive in to the msbc i wanted to ask if you have thought about how to best implement it? the problematic detail is that the codec negotiation happens in the rfcomm thread but the information needs to go to both the sco io thread and into the control thread since the sampling rates differ between cvsd and msbc. i could either delay the creation of the accompanying sco transport until the codec has been decided upon, or add a more complex logic, maybe a fifo instead of the eventfd to pass more complex communications between the threads. there is also a race condition where the plugin may attempt to grab the sco transport before the at negotiation has finished, this leads me to prefer delaying the creation of the sco io thread. thoughts?