 URL : "https://github.com/manodeep/Corrfunc/issues/111" TITLE : severe bug in wtheta BODY : the angular separation between two points is math cos dtheta = x1 x2 + y1 y2 + z1 z2 however, for clustering we only care about the absolute value and not the sign. thus, the computation should have either been for cos^2 dtheta or equivalently, abs x1 x2 + y1 y2 + z1 z2 . all calculations that can produce negative dot products for valid pairs are affected i think since the regular tests and external code validation were for the sdss north footprint, this bug was not uncovered. and only when the correct gridding + offset conditions were implemented in pr 108 did this bug come to front.