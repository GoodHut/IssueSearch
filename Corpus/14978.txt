 URL : "https://github.com/Azure/acs-engine/issues/1116" TITLE : cluster key vault BODY : this is a documentation for k8s 1.8 encryption provider feature ref docs - doc: https://docs.google.com/document/d/1jawpuzg47uhfrvlof-lmw08ojztunw8pvtnxdk3rcf8/edit - doc: https://docs.google.com/document/d/1t2y-9geg9efhhtcdytxptca-f4kq0ryih-c_m1syd0s/edit - code: https://github.com/kubernetes/kubernetes/pull/48574 use case cloud providers will enable users to encrypt kubernetes' secrets saved in etcd for 1.8. 1.9++ is expected to add secrets saved externally . how will that work on azure 1. acs-engine will create clusters with a default azure key vault provisioned by arm. the key vault name is generated dynamically based on cluster fqdn and is saved in /etc/kubernetes/azure.json and will be used. 2. if the cluster is not using the newly introduced msi, the user provided service principal will have create,encrypt and decrypt on vault/keys. if the cluster is using msi, then vms' service principals will be have the same permissions added by the cloud provider as it starts . 3. the cloud provider will be extended to - create a well named default key in the cluster key vault used for encrypting/decrypt etcd secrets - add permission as stated above. - implement encrypt/decrypt interfaces as needed by kubernetes. @jdumars @slack