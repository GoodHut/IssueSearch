 URL : "https://github.com/pravega/pravega/issues/1414" TITLE : bookkeeper error handling BODY : after 1330 is done, the following fixes & improvements need to be done to bookkeeperlog : 1. be able to properly recover from a bookkeeper error. for example, if bookkeeper closes a ledger, the bookkeeperlog does not reopen it. 2. handle operations with unknown outcomes. these can happen when connection to bk/zk is lost during a write; the write eventually times out or fails with an exception, however the write has been committed to the ledger. both of these can take advantage of the retry mechanism in bookkeeperlog : - all writes are queued up and we have a write processor that goes through them and attempts/reattempts to execute them existing behavior . - when a ledgerclosedexception is caught which is not the result of our rollover , open a new one and fence out previous ledgers using the same algorithm we have in there . while doing so, figure out the lastaddconfirmed for each of them. - when a write fails, usually we get back the attempted entry id for that write. if it happens to be before the lastaddconfirmed for its attempted ledger, then this write succeeded. otherwise it needs to be retried.