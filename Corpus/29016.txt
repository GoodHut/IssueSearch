 URL : "https://github.com/DocNow/docnow/issues/14" TITLE : initial login fails BODY : when logging in for the first time you get redirected to twitter and back ok. but the header component does not show you as being logged in. reloading has no effect. clicking login again works. i think there must be a problem with the way the initial login works when a new user has arrived at the application. the console of the server displays this, which hints at the problem: error: can't set headers after they are sent. at validateheader _http_outgoing.js:504:11 at serverresponse.setheader _http_outgoing.js:511:3 at serverresponse.header /users/ed/projects/docnow/node_modules/express/lib/response.js:730:10 at serverresponse.location /users/ed/projects/docnow/node_modules/express/lib/response.js:847:15 at serverresponse.redirect /users/ed/projects/docnow/node_modules/express/lib/response.js:885:18 at /users/ed/projects/docnow/src/server/auth.js:64:9 at layer.handle as handle_request /users/ed/projects/docnow/node_modules/express/lib/router/layer.js:95:5 at next /users/ed/projects/docnow/node_modules/express/lib/router/route.js:137:13 at complete /users/ed/projects/docnow/node_modules/passport/lib/middleware/authenticate.js:250:13 at /users/ed/projects/docnow/node_modules/passport/lib/middleware/authenticate.js:257:15 at pass /users/ed/projects/docnow/node_modules/passport/lib/authenticator.js:421:14 at authenticator.transformauthinfo /users/ed/projects/docnow/node_modules/passport/lib/authenticator.js:443:5 at /users/ed/projects/docnow/node_modules/passport/lib/middleware/authenticate.js:254:22 at /users/ed/projects/docnow/node_modules/passport/lib/http/request.js:60:7 at pass /users/ed/projects/docnow/node_modules/passport/lib/authenticator.js:267:43 at serialized /users/ed/projects/docnow/node_modules/passport/lib/authenticator.js:276:7