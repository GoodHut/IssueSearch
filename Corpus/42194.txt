 URL : "https://github.com/influxdata/telegraf/issues/3557" TITLE : amqp body compression BODY : feature request proposal: when using input plugins, like the logparser, that can put a large amount of text in the body of an amq message over 300k , it can take much longer for telegraf to pull messages from the queue or for rabbit to send them across federated links. it would be great if the amqp output plugin could check the size of the message body and if it's over a configurable amount, gzip the body. the amqp_consumer input plugin would then need to auto-detect the content type and unzip as necessary. current behavior: all messages are plain text without any compression. desired behavior: add a compression option to the amqp_consumer input plugin and amqp output plugin to allow gzip body compression over a configurable amount. use case: why is this important helps with prioritizing requests when telegraf is configured with the logparser plugin and from_beginning set to true, it can dump a huge amount of very large messages onto the queue. it then takes telegraf a long time to pull those messages off of the queue. with several thousand 300k+ messages load balanced across 3 queues on 3 different brokers i've only been able to hit 30 msg/s with 4 telegraf consumers. once the backlog of logparser messages have been processed the throughput skyrockets to 1000 msg/s.