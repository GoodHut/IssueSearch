 URL : "https://github.com/IndySockets/Indy/issues/38" TITLE : http server improvements BODY : users have more or less only two places where they can plug code inside the http response generation: onheaderavailable/onheadersblocked and oncommandget/oncommandother. unfortunately, onheaderavailable happens very early in the processing and does not give much options: the headers are fully unparsed and the user cannot give a reason why the operation is canceled this reason can be provided through onheaderblocked but that requires additional code to save the error inside the connection context . unfortunately, large requests causes two issues: - anonymous connections can cause dos through a resource exhaustion because the request size isn't checked and memory is pre-allocated i.e. ask for 4 gigs of data you you'll kill the process outright . - users are warned of errors only after the while stream has been sent. either merge the onheadersavailable and onheadersblocked events together, or add a new onheaderavailableex event. also need to validate that the request post stream size can be handled by the underlying os platform ie, do not allow 2+ gb on a 32-bit system when using tmemorystream, etc .