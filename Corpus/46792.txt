 URL : "https://github.com/ParRes/Kernels/issues/278" TITLE : mpiopenmp stencil bug BODY : hi, i have been doing some testing with large grid sizes and find the mpi/openmp stencil kernel is giving segmentation faults, eg. grid size 100k, 4 ranks, 1 rank per node: parallel research kernels version 2.17 mpi+openmp stencil execution on 2d grid number of ranks = 4 number of threads = 44 grid size = 100000 radius of stencil = 2 tiles in x/y-direction = 2/2 type of stencil = star data type = double precision compact representation of stencil loop body number of iterations = 20 the following patch seems to resolve: --- stencil.c +++ stencil.c @@ -88,7 +88,7 @@ endif / define shorthand for indexing multi-dimensional arrays with offsets / - define indexin i,j i+radius+ j+radius width+2 radius + define indexin i,j i+radius+ long j+radius width+2 radius / need to add offset of radius to j to account for ghost points / define in i,j in indexin i-istart,j-jstart define indexout i,j i+ j width thanks for making the prk available - hope this helps! regards, mark