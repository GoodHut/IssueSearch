 URL : "https://github.com/mossmatters/HybPiper/issues/34" TITLE : heat map cleanup BODY : matt: here is the code i used for the heatmap, using ggplot. this worked on 25 taxa and 25 genes. no idea of scalability. i will email you the input file i used. require gplots require heatmap.plus set working directory to source file location setwd dirname rstudioapi::getactivedocumentcontext $path only for rstudio here, set the file name of the table generated by get_seq_lengths.py sample.filename = all25concat-bases-count-matrix_names.tab you should not need to change anything below this line! ------------------------------------------------------- library ggplot2 library reshape2 sample.data= as.matrix read.table sample.filename,header=t,row.names=1 sample.len = sample.data 2:nrow sample.data , reference.len = as.numeric sample.data 1, calculate the percentage length recovered relative to the reference. percent.len=sweep sample.len,2,as.numeric reference.len ,'/' percent.len = ifelse percent.len>1,1,percent.len percent.long = melt percent.len ggplot data = percent.long, aes x=var2, y=var1, fill = value + geom_raster + guides fill=false + remove this line if you want the heat scale to appear scale_fill_gradient high = 132b43 , low = 56b1f7 + theme axis.text.x = element_text angle = 90, hjust = 1 + ylab null +xlab null + theme axis.text.y=element_text face= italic ggsave fern_gene_refined_scale_names.png , height = 4, width = 6, units = in