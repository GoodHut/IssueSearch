 URL : "https://github.com/biocore/unifrac/issues/46" TITLE : bug: root evaluation BODY : first observed by @eldeveloper. previously, we were not evaluating the root node should not have a length. however, there is a pathological case where it can: if there is a single descendent node from the root. in agreement with scikit-bio's treenode.prune , ssu's collapse method pushes branch length to the parent. if the root has a single descendent node, this means the root adopts the length attribute. this behavior impacted ssu as we were not computing unifrac at the root node as it should not be necessary. the reason this likely did not impact skbio is because fast unifrac evaluates the root even though it also should not be strictly necessary . however, this suggests a bug in skbio and ssu, as the prune and collapse methods respectively probably should not push to the root if the root has a single descendent node. the immediate fix for ssu is to allow evaluation of the root.