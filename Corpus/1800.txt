 URL : "https://github.com/scipy/scipy/issues/7623" TITLE : gmres issues BODY : the docstring of the sparse iterative solver scipy.sparse.linalg.isolve.gmres has the following issues: - the callback argument: rk is in fact not the residual vector, but the residual norm cf. 6198 . - the tol argument: it seems, that stoptest2 fortran function uses only a relative test w.r.t. the right-hand side norm. moreover, it seems that a preconditioned residual is used for the test might be related to 2694 . the call to gmres sometimes for a small maxiter? does not return the found solution, e.g. when the maxiter=10 , it seems to return the initial guess, while for maxiter=20 it does return the found solution. for example: the residual norm is printed using a callback, no preconditioning : - maxiter=10 sfepy: nls: iter: 0, residual: 1.200000e+01 rel: 1.000000e+00 sfepy: iterative-s: iteration 1: |ax-b| = 6.952609e-01 <snip> sfepy: iterative-s: iteration 10: |ax-b| = 2.070826e-01 sfepy: iterative-s: gmres convergence: 10 number of iterations sfepy: nls: iter: 1, residual: 1.200000e+01 rel: 1.000000e+00 - here the last line reports the new residual norm, which is the same as in the first line - maxiter=20 sfepy: nls: iter: 0, residual: 1.200000e+01 rel: 1.000000e+00 sfepy: iterative-s: iteration 1: |ax-b| = 6.952609e-01 <snip> sfepy: iterative-s: iteration 20: |ax-b| = 1.121924e-01 sfepy: iterative-s: gmres convergence: 20 number of iterations sfepy: nls: iter: 1, residual: 1.346308e+00 rel: 1.121924e-01 tested with scipy 0.18.1, as for some reason i am unable to compile the master branch. build/src.linux-x86_64-2.7/scipy/optimize/cobyla/_cobylamodule.c:400:109: error: ‘npy_farray’ undeclared first use in this function