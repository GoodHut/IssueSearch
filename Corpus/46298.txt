 URL : "https://github.com/kiselgra/c-mera/issues/82" TITLE : macro weirdness issue BODY : i'm not sure that an issue tracker is the appropriate place to ask this, but i do understand it's a convenient place for you. i'm having trouble figuring what is going on here i've hacked this out of my larger code base to try and get rid of stuff that should be irrelevant : lisp defmacro decl% &rest bindings &body body if true decl ,@bindings ,@body ; +nil defmacro with-unsuccessful-cleanup cleanup &body protected let label gensym cleanup_ result gensym result- decl% int ,result = 0 macrolet return value let result ',result label ',label progn = ,result ,value goto ,label ,@protected label ,label when < ,result 0 ,cleanup return ,result function add-connection struct identity id -> int with-unsuccessful-cleanup free node with-unsuccessful-cleanup fclose pref node stream move-identity & pref node id id return 0 if i run cm c++ then i get the following output: cm c++ test.lisp shell ;compiler warnings : ; in an anonymous lambda form: undefined function move-identity ; in an anonymous lambda form: undeclared free variable id unbound variable: id the message makes it sound like sbcl is expecting to be able to invoke move-identity , but that shouldn't be the case, surely?