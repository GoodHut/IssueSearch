 URL : "https://github.com/facebook/hhvm/issues/7659" TITLE : base64 stream filter BODY : hey! in 70441c3de6e0e6af51b45cc9241c5b60a2269fac, convert.base64- encode|decode stream filters has been added. this is nice but unfortunatelly, the current implementation does not take care of the base64 spec when buffering the read/write calls. take the following example: // replace by a file on your system $binary = file_get_contents __dir__.'/fixtures/model/binary' ; $size = strlen $binary ; $file = fopen 'php://temp', 'w+' ; stream_filter_append $file, 'convert.base64-encode', stream_filter_write ; for $i = 0; $i < $size; ++$i { fwrite $file, substr $binary, $i, 1 ; } rewind $file ; if stream_get_contents $file === base64_encode $binary { echo 'ok'; } else { echo 'ko'; } the expected result of this snippet is ok but it is not the same snippet using the php engine renders ok .