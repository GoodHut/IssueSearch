 URL : "https://github.com/riscv/riscv-isa-sim/issues/88" TITLE : trap return instructions BODY : hi, i wonder if there is a mismatch between the privilege-level spec and the spike simulator. in the spec version 1.9.1 released on 11/04/16 page 22, the semantics of xret are described as follows, the mret, hret, sret, or uret instructions are used to return from traps in m-mode, h-mode, s-mode, or u-mode respectively. when executing an xret instruction, supposing xpp holds the value y, yie is set to xpie; the privilege mode is changed to y; xpie is set to 1; and xpp is set to u. which means if we execute mret in m-mode, and returns to say s-mode, mpie should be set to 1, but in the simulator, riscv/insns/mret.h s = set_field s, mstatus_mpie, 0 ; could anyone tell if this is indeed a mismatch or just my misunderstanding? thank you! hongce