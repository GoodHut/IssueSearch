 URL : "https://github.com/tidwall/tile38/issues/141" TITLE : distances for geofences BODY : the distance keyword output the distance of an object for the nearby command. it works with standard queries, but does not output for geofences when the fence keyword is specified. this works: > nearby fleet distance point 33 -115 10000 { ok :true, objects : { id : hello , object :{ type : point , coordinates : -115.001,33.002 }, distance :241.15} , count :1, cursor :0, elapsed : 206.496Âµs } this does not: > nearby fleet fence distance point 33 -115 10000 { ok :true, live :true} { command : set , group : 5899a597d5eefdb400c8c50c , detect : inside , key : fleet , time : 2017-02-07t03:46:47.830532366-07:00 , id : hello , object :{ type : point , coordinates : -115.001,33.002 }} the distance field should appear at the same level as hello and object . i suspect that the reason is distance calculation https://github.com/tidwall/tile38/blob/04290ec/controller/search.go l311-l314 for standard queries is happening outside of the scanwriter.writeobject method https://github.com/tidwall/tile38/blob/04290ec/controller/search.go l311-l314 , and the geofence logic is not including the calculation. this should be fixed.