 URL : "https://github.com/infphilo/hisat2/issues/112" TITLE : nh tag issue BODY : hi, for an allele specific expression analysis, one of the ways to reduce ambiguous mapping reads is to extract or use only unique mapping not referring to primary alignment or unique alignment here reads from an alignment file. for this, highest mapq score column 5 in a bam file can be used as a uniquely mapped read will always have the highest mapping quality and also the nh no. of hits tag will always be 1 nh:i:1 . hisat2 versions 2.0.4 and 2.0.5 have given the uniquely mapping reads a mapq of 60 and their nh tag is always 1. extracting or using uniquely mapping reads from bam files produced from these versions of hisat is fairly simple can use samtools view -q 60 for considering only uniqely mapped reads . if we do not make a new bam file consisiting of only reads having mapq=60 from the original bam file, we can also instruct downstream tools such as variant callers or read counter tools to consider reads having mapq=60. unfortunately, some bam files i am dealing with have been produced using hisat2 v2.0.0-beta in which there is a bug where in the nh tag is not properly assigned. to be more specific, the highest mapq assigned is 255 for uniqely mapped read but the nh tag is not always 1. this bug has been solved v 2.0.4 onwards though. the issue is that some reads which have the score as 255, have nh:i:2 or nh:i:3 as well. also, some reads which have nh:i:1 have scores 0 or 1 as well. can i take the reads having mapq 255 as unique mapping?