 URL : "https://github.com/nextcloud/server/issues/5179" TITLE : adding self to csp fails BODY : <!-- thanks for reporting issues back to nextcloud! this is the issue tracker of nextcloud, if you have any support question please check out https://nextcloud.com/support this is the bug tracker for the server component. find other components at https://github.com/nextcloud/ for reporting potential security issues please see https://nextcloud.com/security/ to make it possible for us to help you please fill out below information carefully. you can also use the issue template application to prefill most of the required information: https://apps.nextcloud.com/apps/issuetemplate --> steps to reproduce put the following into your app.php : $policy = new ocp\appframework\http\contentsecuritypolicy ; $policy->addallowedscriptdomain '\'self\'' ; \oc::$server->getcontentsecuritypolicymanager ->adddefaultpolicy $policy ; expected behaviour 'self' in the csp header actual behaviour no 'self' e.g. on all shares . server configuration php version: 7.0.19 nextcloud version: 12.0.0 updated from an older nextcloud/owncloud or fresh install: updated dirty fix if you add 'self' please note the following space 'self'_ everything works as expected. cc @lukasreschke