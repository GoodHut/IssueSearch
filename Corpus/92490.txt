 URL : "https://github.com/Yomguithereal/talisman/issues/103" TITLE : wrong number of centroids BODY : i'm trying to cluster sentences using tf-idf, cosine similarity and k-means algorithm. i calculate tf-idf using natural library then i prepare vectors that look like: 0, 0, 0, 0, 0, 1.24225242, 0, 0, 0, 0, 0 where every value represents a word and the whole vector represents a sentence in case of this example it would be a sentence with one word . then i try to use talisman library to make clusters using created vectors and metrics/distance/cosine . the problem is that i get: typeerror: cannot read property 'length' of undefined at kmeans.cosine as distance .../node_modules/talisman/metrics/distance/cosine.js:29:21 at kmeans.iterate .../node_modules/talisman/clustering/k-means.js:164:22 at kmeans.run .../node_modules/talisman/clustering/k-means.js:224:12 at kmeans .../node_modules/talisman/clustering/k-means.js:243:21 at object.<anonymous> .../lev-kmeans.js:39:22 at module._compile module.js:570:32 at object.module._extensions..js module.js:579:10 at module.load module.js:487:32 at trymoduleload module.js:446:12 at function.module._load module.js:438:3 i tried looking into the code and the reason it fails is this piece of code https://github.com/yomguithereal/talisman/blob/master/src/clustering/k-means.js l148 . for let j = 0, m = this.dimensions; j < m; j++ { const d = this.distance vector, this.centroids j ; if d < min { min = d; minindex = j; } } it tries to enter cosine.js functions using undefined as the second vector. for example for k equal 2 it should generate 2 centroids. it does. but this loop is trying to access centroids with very high indices like 181 this.dimensions and thus m is equal 182 . it works fine when i tested it for simpler stuff using euclidean distances.