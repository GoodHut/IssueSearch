 URL : "https://github.com/spree-contrib/spree_marketplace/issues/22" TITLE : unauthorized - 302 BODY : require 'oauth2' class spree::admin::stripeconnectcontroller < spree::admin::basecontroller before_filter :load_supplier before_filter :set_client, :only => :setup, :stripeauth def set_client @client = oauth2::client.new env 'stripe_client_id' , env 'stripe_api_key' , {:site => 'https://connect.stripe.com', :authorize_url => '/oauth/authorize', :token_url => '/oauth/token'} end def index end _ def stripeauth _ brand_id = spree_current_user.supplier_id url = @client.auth_code.authorize_url {:scope => 'read_write'} logger.info redirect: {brand_id}: {@client.inspect}: {url} redirect_to url end def setup code = params code @resp = @client.auth_code.get_token code, :params => {:scope => 'read_write'} @access_token = @resp.token @refresh_token = @resp.refresh_token @stripe_user_id = @resp stripe_user_id @stripe_publishable_key = @resp stripe_publishable_key spreestripeaccount.save_tokens @access_token, @refresh_token, @stripe_user_id, @stripe_publishable_key redirect_to /be/admin/ end private def load_supplier @supplier = spree::supplier.friendly.find params :supplier_id end end hi, i keep getting unauthorized when calling stripeauth. where is the permission of supplier set?