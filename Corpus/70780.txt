 URL : "https://github.com/ansible/ansible/issues/29221" TITLE : zfs volsize idempotence BODY : from @mavit on 2015-08-26t14:25:44z issue type:
- bug report ansible version: ansible 1.9.1 configured module search path = none environment: solaris 10 and 11. steps to reproduce: the following task will return changed every time you run it, because it naively compares the volsize property to the string returned by the zfs get command: - zfs: name=rpool/swap state=present volsize=2147483648 by default, the output of the zfs get command is formatted in human-readable style, meaning that the string that you set isn't necessarily the same string that you'll get. for example: > sudo zfs set volsize=6145m rpool/dump
> zfs get volsize rpool/dump
name property value source
rpool/dump volsize 6.00g local this confuses the ansible zfs module. my particular use-case is that i wish to set the dump volume to be half the memory size, without having to do something messy with jinja2 to format that into, say, a whole number of gigabytes. i propose that the ansible zfs module passes the -p option to zfs get , causing it to format sizes as integers. this won't entirely solve the problem, but at least it'll be predictable what format i need to use to get idempotence. if this sounds reasonable, i can create a pull request. copied from original issue: ansible/ansible-modules-extras 879