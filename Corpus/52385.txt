 URL : "https://github.com/ParabolInc/action/issues/698" TITLE : clean up signup/signin BODY : currently, what we do is a huge mess with trusting data from auth0 over our own db, long signins, etc. the way forward: - sign in with auth0, it returns openid rol tms in the token. - based on that if !token.tms then redirect to the welcome wizard, else, /me . - call updateuserwithauthtoken but don't await it. this means the preferred name & photo might not be there as soon as they get to the next screen, but maybe it will since the next screen is a huge chunk. either way, it's better than waiting. - updateuserwithauthtoken validates the token the client gives it, and if no tms is present, it fetches the profile from auth0 and inserts a new user into the db. then, it fetches the user.preferredname, email, etc and sends it back to the client. that reduces it to 2 async calls for new users & 1 for returning users. next, we remove name & picture from auth0, just trust our db. finally, this still doens't solve the duplicate tms problem. we like the tms coming from auth0 because that means only 1 round trip for a login. otherwise, we'd have to get the auth0 token, take that to our server, validate it, and return a new token with the tms field. i think the replication is fine as long as we never have to wait for it. for example, when we add someone to a new team, just hit up auth0 with that new tms info async. prioritizing on epic 2 because i'm running into a lot of stuff that involves exactly this in the new org creations.