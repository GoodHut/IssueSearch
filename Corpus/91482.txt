 URL : "https://github.com/owncloud/core/issues/29503" TITLE : transition to account ids BODY : currently, most tables in oc are based on the immutable user id. changing all tables to use account id instead would take a long time and the benefit of being able to change a user id is deferred to the moment where all tables were adjusted. also changing too many at once in the hope to have this feature soon is time costy and dangerous. i suggest to use an alternate temporary route: 1. introduce a new column oc_accounts.internal_user_id. the column defaults to the same value as oc_accounts.user_id at user creation or import. 1. let the admin rename the user id, in which case only oc_accounts.user_id is changed. 1. internally, we always use internal_user_id when mapping with other tables. so the code needs to be rewired to work with internal_user_id for internal operations, but keep user_id when dealing with logins or user:sync. once this is done, we already gain the benefit of user id renaming. after that, we can take our time to migrate all other tables one by one to use oc_account.id instead and use the opportunity to add a foreign key there... . once all tables are migrated, we can get rid of oc_accounts.internal_user_id and make it use user_id again. @tomneedham @cdamken @butonic @deepdiver1975 @jvillafanez @pmaier1