 URL : "https://github.com/SergeyFrolov/gotapdance/issues/10" TITLE : found a segfault BODY : seems pretty rare; haven't been able to replicate it. this is commit e9db55c52d8e157d8eb90d20dc6641f369ec8bd8, log msg_close , from yesterday. 15:32:36 flow 115 successfully connected to tapdance station! 15:32:40 flow 60 establishtlstodecoy failed with dial tcp 192.122.190.104:443: getsockopt: connection timed out panic: runtime error: invalid memory address or nil pointer dereference signal 0xb code=0x1 addr=0x0 pc=0x5087d4 goroutine 446 running : panic 0x74fdc0, 0xc82000a140 /usr/lib/go-1.6/src/runtime/panic.go:481 +0x3e6 github.com/zmap/zgrab/ztools/ztls. conn .handshake 0x0, 0x0, 0x0 /home/fred/code/go/src/github.com/zmap/zgrab/ztools/ztls/conn.go:1033 +0x1d4 github.com/zmap/zgrab/ztools/ztls. conn .read 0x0, 0xc8205e0100, 0x4034, 0x4034, 0x0, 0x0, 0x0 /home/fred/code/go/src/github.com/zmap/zgrab/ztools/ztls/conn.go:953 +0x6c github.com/sergeyfrolov/gotapdance/tapdance. tapdanceconn .read_as 0xc8205ae300, 0xc8205e4200, 0x4034, 0x4034, 0x0, 0x0, 0x7f4a24485be8, 0xc8204c1220 /home/fred/code/go/src/github.com/sergeyfrolov/gotapdance/tapdance/tdconn.go:214 +0x1af github.com/sergeyfrolov/gotapdance/tapdance. tapdanceconn .read 0xc8205ae300, 0xc820598100, 0x4034, 0x4034, 0x0, 0x0, 0x0 /home/fred/code/go/src/github.com/sergeyfrolov/gotapdance/tapdance/tdconn.go:177 +0xbe github.com/sergeyfrolov/gotapdance/tapdance. tapdanceflow .redirect.func1 /home/fred/code/go/src/github.com/sergeyfrolov/gotapdance/tapdance/flow.go:58 +0xd8 created by github.com/sergeyfrolov/gotapdance/tapdance. tapdanceflow .redirect /home/fred/code/go/src/github.com/sergeyfrolov/gotapdance/tapdance/flow.go:100 +0x308