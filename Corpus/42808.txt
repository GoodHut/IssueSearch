 URL : "https://github.com/apache-spark-on-k8s/spark/issues/504" TITLE : can't find snappy lib BODY : i built off the 2.2 branch. works great until it tries to write to parquet files. then it can't seem to initialize / find org.xerial.snappy.snappy. i see snappy in the jars directory of the spark distro. my endpoint is s3a:\bucket\etc and i've included the following jars. i'm not sure if this is something odd in spark distro or if i'm doing something odd. thanks! i can provide the full error log output if that'll help. 2017-09-22 22:51:57 info dagscheduler:54 - resultstage 3 parquet at nativemethodaccessorimpl.java:0 failed in 4.996 s due to job aborted due to stage failure: task 8 in stage 3.0 failed 4 times, most recent failure: lost task 8.3 in stage 3.0 tid 434, 10.2.106.11, executor 7 : org.apache.spark.sparkexception: task failed while writing rows at org.apache.spark.sql.execution.datasources.fileformatwriter$.org$apache$spark$sql$execution$datasources$fileformatwriter$$executetask fileformatwriter.scala:272 at org.apache.spark.sql.execution.datasources.fileformatwriter$$anonfun$write$1$$anonfun$apply$mcv$sp$1.apply fileformatwriter.scala:191 at org.apache.spark.sql.execution.datasources.fileformatwriter$$anonfun$write$1$$anonfun$apply$mcv$sp$1.apply fileformatwriter.scala:190 at org.apache.spark.scheduler.resulttask.runtask resulttask.scala:87 at org.apache.spark.scheduler.task.run task.scala:108 at org.apache.spark.executor.executor$taskrunner.run executor.scala:335 at java.util.concurrent.threadpoolexecutor.runworker threadpoolexecutor.java:1142 at java.util.concurrent.threadpoolexecutor$worker.run threadpoolexecutor.java:617 at java.lang.thread.run thread.java:748 caused by: java.lang.noclassdeffounderror: could not initialize class org.xerial.snappy.snappy