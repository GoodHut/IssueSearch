 URL : "https://github.com/samayo/bulletproof/issues/80" TITLE : check file type BODY : hello, i've come across an article on internet: https://imperavi.com/redactor/docs/security/ there is a section about image file type detection. what do you think about this function? function is_image $image_path { if !$f = fopen $image_path, 'rb' { return false; } $data = fread $f, 8 ; fclose $f ; // signature checking $unpacked = unpack h12 , $data ; if array_pop $unpacked == '474946383961' || array_pop $unpacked == '474946383761' return gif ; $unpacked = unpack h4 , $data ; if array_pop $unpacked == 'ffd8' return jpg ; $unpacked = unpack h16 , $data ; if array_pop $unpacked == '89504e470d0a1a0a' return png ; return false; } maybe you can add into your library?