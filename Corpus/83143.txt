 URL : "https://github.com/rollup/rollup/issues/1462" TITLE : bug: catch symbol changed BODY : while using rollup's sources as a test case for uglify-es i stumbled across a rollup catch symbol replacement bug. i was unable to make a simple standalone test case, but if you apply the following patch to rollup's source tree itself then the bug can easily be reproduced with npm test : patch --- a/rollup.config.js +++ b/rollup.config.js @@ -24,7 +24,7 @@ export default { buble { include: 'src/ ', 'node_modules/acorn/ ' , target: { - node: '0.12' + node: 6 } } , diff --git a/src/utils/fs.js b/src/utils/fs.js index db790a9..b2230da 100644 --- a/src/utils/fs.js +++ b/src/utils/fs.js @@ -1,13 +1,13 @@ import as fs from 'fs'; -import { dirname } from './path.js'; +import { dirname as i } from './path.js'; export from 'fs'; function mkdirpath path { - const dir = dirname path ; + const dir = i path ; try { fs.readdirsync dir ; - } catch err { + } catch i { mkdirpath dir ; fs.mkdirsync dir ; } $ npm test ... error compiling dist/rollup.js: --- 89 : function mkdirpath path$$1 { 90 : const dir = path.dirname path$$1 ; 91 : try { 92 : fs.readdirsync dir ; 93 : } catch path.dirname { ^ unexpected token 93:15 the catch symbol should never be replaced as it is essentially a scoped variable declaration in the catch block. note: a yet to be released fix for acorn may have to be applied prior to running npm test due to an es6 bug: https://github.com/ternjs/acorn/issues/561