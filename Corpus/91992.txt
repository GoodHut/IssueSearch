 URL : "https://github.com/jcmoyer/rust-lua53/issues/88" TITLE : use ptr::write in example BODY : this example for function state::new_userdata_typed https://docs.rs/lua/0.0.10/lua/struct.state.html method.new_userdata_typed is only correct if mystruct does not have a destructor. the correct way to move a value into an uninitialized location is std::ptr::write https://doc.rust-lang.org/nightly/std/ptr/fn.write.html rust unsafe { state.new_userdata_typed = mystruct::new ... ; } state.set_metatable_from_registry mystruct ;