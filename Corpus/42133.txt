 URL : "https://github.com/open-falcon/falcon-plus/issues/58" TITLE : agent -check coredump BODY : > panic: runtime error: invalid memory address or nil pointer dereference > signal sigsegv: segmentation violation code=0x1 addr=0x48 pc=0x47b4fc > > goroutine 1 running : > panic 0x776d80, 0xc420010140 > /usr/local/go/src/runtime/panic.go:500 +0x1a1 > github.com/open-falcon/falcon-plus/modules/agent/funcs.devicemetrics 0x774a20, 0xc42004fd90, 0xc42004fc60 > /home/ry/go/src/github.com/open-falcon/falcon-plus/modules/agent/funcs/dfstat.go:21 +0x14c > github.com/open-falcon/falcon-plus/modules/agent/funcs.checkcollector > /home/ry/go/src/github.com/open-falcon/falcon-plus/modules/agent/funcs/checker.go:21 +0x1e6 > main.main > /home/ry/go/src/github.com/open-falcon/falcon-plus/modules/agent/main.go:27 +0x1dc 看了一下代码发现大概是这行： $home/go/src/github.com/open-falcon/falcon-plus/modules/agent/funcs/dfstat.go:21 此时 g.config 获取的还是初始化为nil的指针。加上 -c 参数执行配置文件一样的效果，而且main里check执行是在parseconfig之前执行的，所以我以为check是不需要配置文件的。所以感觉这行需要加个nil判断 if g.config != nil && len g.config .collector.mountpoint > 0