 URL : "https://github.com/MayInstitute/MayInstitute2017/issues/9" TITLE : sample size calculation BODY : dear @meenachoi - your sample size calculation example, at the end of part 5a, can be simplified as shown below: r delta <- seq 0.1, 0.7, .1 sigma <- seq 0.1,0.5,.1 d <- expand.grid delta = delta, sigma = sigma d$d <- d$delta / d$sigma d$n <- sapply d$d, function .d { res <- pwr.t.test d = .d, sig.level = 0.05, power = 0.95 ceiling res$n } d$sigma <- factor d$sigma which produces r > head d delta sigma d n 1 0.1 0.1 1 27 2 0.2 0.1 2 8 3 0.3 0.1 3 5 4 0.4 0.1 4 4 5 0.5 0.1 5 3 6 0.6 0.1 6 3 and can be plotted with the sample ggplot2 code that you have r library ggplot2 p <- ggplot data = d, aes x = delta, y = n, group = factor sigma , colour = sigma p + geom_line + geom_point ! rplot001 https://cloud.githubusercontent.com/assets/384198/25768683/bdfd509c-3200-11e7-868e-ef8717e5996e.png