 URL : "https://github.com/RWarnecke/TPrinterInfo/issues/1" TITLE : how get job copies? BODY : how get job copies? i try insert function , but job copies always 1... tprintercustom = class tcomponent ... function getjobcopies: integer; ... tprnjobinfo = class tprintercustom public ... property jobcopies : integer read getjobcopies; ... function tprintercustom.getjobcopies: integer; type tjobs = array 0..1000 of job_info_2; pjobs = ^tjobs; var hprinter, devm: thandle; bytesneeded, numjobs: cardinal; pj: pjobs; begin result := 0; if fallinfos.count <> 0 then begin pprinter := fallinfos.items fprinterindex ; printer.getprinter pprinter^.pprintername, pprinter^.pdrivername, pprinter^.pportname, devm ; {$ifdef delphi10_up} if not openprinter pprinter^.pprintername, hprinter, nil then raiselastwin32error; {$else} if openprinter pprinter^.pprintername, hprinter, nil then {$endif} try enumjobs hprinter, 0, 1000, 2, nil, 0, bytesneeded, numjobs ; pj := allocmem bytesneeded ; {$ifdef delphi10_up} if not enumjobs hprinter, 0, 1000, 2, pj, bytesneeded, bytesneeded, numjobs then raiselastwin32error; {$else} if enumjobs hprinter, 0, 1000, 2, pj, bytesneeded, bytesneeded, numjobs then {$endif} result := pj^ fjobindex .pdevmode^.dmcopies; // result for copies finally closeprinter hprinter ; end; end; end;