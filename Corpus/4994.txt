 URL : "https://github.com/pfohjo/nitro-kmod/issues/2" TITLE : is this a bug? BODY : hi, in nitro_main.c function nitro_ioctl_attach_vcpus.c one can see the following code segment. kvm_for_each_vcpu r, v, kvm { nvcpus->ids r = v->vcpu_id; kvm_get_kvm kvm ; nvcpus->fds r = create_vcpu_fd v ; if nvcpus->fds r <0 { for i=r;r>=0;i-- { nvcpus->ids r = 0; nvcpus->fds i = 0; kvm_put_kvm kvm ; } goto error_out; } } it seems that lines 127 and line 128 are wrong, shouldn't it be kvm_for_each_vcpu r, v, kvm { nvcpus->ids r = v->vcpu_id; kvm_get_kvm kvm ; nvcpus->fds r = create_vcpu_fd v ; if nvcpus->fds r <0 { for i=r;i>=0;i-- { nvcpus->ids i = 0; nvcpus->fds i = 0; kvm_put_kvm kvm ; } goto error_out; } } i understand that it is only in error path but still. best regards, s.p.