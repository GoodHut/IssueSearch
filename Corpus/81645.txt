 URL : "https://github.com/cyrusimap/cyrus-imapd/issues/2178" TITLE : 2.5.x sigsegv on propfind BODY : i got many coredumps on 2.5.x murder frontends accessing cyrus_httpd with windows 7 explorer webdav. don't ask why my college did that anyway. according to the coredumps backtrace it crashes here: gdb frame 4 4 0x00007f2de5e1834b in meth_propfind txn=<value optimized out>, params=<value optimized out> at imap/http_dav.c:4367 4367 xmlfree freeme->name ; which is the done section of meth_propfind done: / free the entry list / elist = fctx.elist; while elist { struct propfind_entry_list freeme = elist; elist = elist->next; xmlfree freeme->name ; free freeme ; } and gdb frame 3 3 0x00007f2de199adee in malloc_printerr action=3, str=0x7f2de1a7db90 munmap_chunk : invalid pointer , ptr=<value optimized out>, ar_ptr=<value optimized out> at malloc.c:6360 6360 __libc_message action & 2, says freeme->name is an invalid pointer . also note that xmlfree is aliased to free by libxml2. so, no libxml frame in the backtrace. after comparing head with 2.5 tree i think this is the backported fix: --- a/imap/http_dav.c	2016-07-22 03:55:57.000000000 +0200 +++ b/imap/http_dav.c	2017-10-17 16:13:24.436152469 +0200 @@ -2201,7 +2201,7 @@ known_namespaces entry->ns .href, known_namespaces entry->ns .prefix ; - nentry->name = bad_cast entry->name; + nentry->name = xmlstrdup bad_cast entry->name ; nentry->ns = fctx->ns entry->ns ; if allowed { nentry->flags = entry->flags;