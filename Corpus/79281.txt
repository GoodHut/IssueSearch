 URL : "https://github.com/elkarte/Elkarte/issues/2874" TITLE : security edits in images BODY : i hope it's not a breach of protocol to post this bug in two forks that share the same code... i'm a photo junkie. many of my photos are getting rejected in the other forum i admit i haven't yet tried elkarte . i see you have the exact same code in the graphics subs module... which i think means you will also encounter the same false security fails. _this is pretty frustrating for users trying to use the forum to share photography._ in short, the preg_match checks in checkimagecontents will find matches in many images. in my experience, about 10-20% of photos are _erroneously_ failing security checks, even on things like 'body' and 'html'. we're losing a statistical battle. in my mind, the image encoding is like the thousand monkeys typing away & accidentally writing shakespeare's works. only they just have to get a hit on something like 'body' or 'html'... in a big enough .jpg, odds are pretty good that happens. i'd be interested in knowing the best approach to fix - for both forums. my proposed solution has evolved as i have learned more over the last couple of weeks. currently, my thinking is to not do the preg_match checks at all if the image is to be re-encoded. the re-encoding should clean it up and strip out malicious strings. i'd like to know if you agree. if so, the fix is easy. ========== an aside: one minor issue with the 'extended' search string: |\<\?|\<%| is equivalent to |\<| ========== this is one of my photos. it fails the security check, due to a match on fws\x06: ! 3e53beb4-f879-11e6-9bbf-8f69aade5454 https://cloud.githubusercontent.com/assets/23568484/23235264/bc84caea-f909-11e6-8136-5887b63dbed0.jpg