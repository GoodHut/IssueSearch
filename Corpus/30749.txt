 URL : "https://github.com/secdev/scapy/issues/729" TITLE : question to ppp_lcp BODY : hi, when working with the scapy.layers.ppp.py of the scapy-master branch, i came across the following question: class ppp_lcp has a data field instead of an option field. due to this it's not possible to handle the ppp_lcp_options properly. imho the following proposal see python comments should fix the problem: python class ppp_lcp_option packet : name = ppp lcp option fields_desc = byteenumfield type , none, _ppp_lcp_optiontypes , fieldlenfield len , none, fmt= b , length_of= data , adjust=lambda p,x:x+2 , strlenfield data , none, length_from=lambda p:p.len-2 def extract_padding self, pay : return , pay registered_options = {} @classmethod def register_variant cls : cls.registered_options cls.type.default = cls @classmethod def dispatch_hook cls, _pkt=none, args, kargs : if _pkt: o = ord _pkt 0 return cls.registered_options.get o, cls return cls class ppp_lcp moved after ppp_lcp_option class ppp_lcp packet : name = ppp link control protocol fields_desc = byteenumfield code , 5, _ppp_lcptypes , xbytefield id , 0 , fieldlenfield len , none, fmt= h , length_of= data , adjust=lambda p, x: x + 4 , fieldlenfield len , none, fmt= h , length_of= options , adjust=lambda p, x: x + 4 , strlenfield data , , length_from=lambda p:p.len-4 packetlistfield options , , ppp_lcp_option, length_from=lambda p:p.len-4, comment are welcome. regards lidl