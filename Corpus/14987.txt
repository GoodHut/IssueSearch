 URL : "https://github.com/clflau/eeb-174-final-project/issues/1" TITLE : code from meeting BODY : with clive cluster3 <- read.csv ~/desktop/mean_cluster3_counts.csv , sep = \t get rid of dups cluster3 <- cluster3 !duplicated cluster3$name , name the rows rownames cluster3 <- cluster3$name colnames cluster3 subset to one gene only early_planula <- cluster3$early.planula early_planula <- early_planula 1:20 names early_planula <- cluster3$name 1:20 early_planula early_planula evm.model.seg100.4 make an empty matrix gene_ratios <- matrix na, nrow = length early_planula , ncol = length early_planula rownames gene_ratios <- names early_planula colnames gene_ratios <- names early_planula write a loop that iterates over all genes in early_planula for current_gene in names early_planula { now, go through every other gene for other_gene in names early_planula { expression_ratios <- early_planula current_gene / early_planula other_gene +.000001 gene_ratios current_gene,other_gene <- expression_ratios } } ------------------------ work with correlations instead of ratios cluster3sub <- cluster3 1:20, make an empty matrix gene_ratios <- matrix na, nrow = length early_planula , ncol = length early_planula rownames gene_ratios <- names early_planula colnames gene_ratios <- names early_planula for current_gene in rownames cluster3sub { for other_gene in rownames cluster3sub { corr = cor as.numeric cluster3sub current_gene,2:8 , as.numeric cluster3sub other_gene, 2:8 gene_ratios current_gene, other_gene <- corr } } pdf ~/desktop/heatmap_for_clive.pdf , width = 15, height = 15 corrplot gene_ratios, type = lower dev.off