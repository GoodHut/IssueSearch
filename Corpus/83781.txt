 URL : "https://github.com/matplotlib/pytest-mpl/issues/45" TITLE : close figure after saving BODY : i have a number of parameterized tests that generate ~150 pngs at ~500kb per image. the test suite not only uses a lot of memory >10gb but it also becomes incredibly slow after ~20 images. this seems to be because the figure objects are not closed. the matplotlib warning can be seen with --strict note i had to register mpl_image_compare as a marker in pytest.ini : $ pytest test/test_plotting.py -s --strict -v ... ... ... test/test_plotting.py::test_plot test/data/set20.csv /home/venv/local/lib/python2.7/site-packages/matplotlib/pyplot.py:524: runtimewarning: more than 20 figures have been opened. figures created through the pyplot interface matplotlib.pyplot.figure are retained until explicitly closed and may consume too much memory. to control this warning, see the rcparam figure.max_open_warning . max_open_warning, runtimewarning passed ... this fixed it: https://github.com/gshiba/pytest-mpl/commit/40a0b513d3870e82bb42e20bd2734826ed5a5d2e