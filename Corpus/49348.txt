 URL : "https://github.com/grosser/parallel/issues/197" TITLE : the mutex params leak BODY : ruby require parallel options = { in_processes: 3 } results = parallel.map 'a','b','c' , options { |one_letter| puts one_letter } puts options.inspect {:in_processes=>3, :mutex=> <thread::mutex:0x000000021781b0>, :return_results=>true} the instance of mutex created in internals is exposed out scope of block, and remains end affect the perform of cg this behavior can be avoided simple cloning the options params in begin 2.4.0-rc1 :001 > a = {a: a } => {:a=> a } 2.4.0-rc1 :002 > b= a.clone => {:a=> a } 2.4.0-rc1 :003 > b :c = c => c 2.4.0-rc1 :004 > b => {:a=> a , :c=> c } 2.4.0-rc1 :005 > a => {:a=> a } 2.4.0-rc1 :006 > b.object_id => 14202320 2.4.0-rc1 :007 > a.object_id => 14220180